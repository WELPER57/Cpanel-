<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welper Official - Panel Manager</title>
    <!-- Load React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        body {
            background: #000000;
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
        }
        .glass-effect {
            background: rgba(30, 0, 60, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(168, 85, 247, 0.3);
        }
        .gradient-text {
            background: linear-gradient(90deg, #8b5cf6, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-primary {
            background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
        }
    </style>
</head>
<body class="text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        function App() {
            // ============ LOGIN STATE ============
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            
            // ============ PANEL STATE ============
            const [activeMenu, setActiveMenu] = useState('dashboard');
            const [nameServer, setNameServer] = useState('');
            const [cpu, setCpu] = useState('1');
            const [disk, setDisk] = useState('1');
            const [result, setResult] = useState(null);
            const [createdCount, setCreatedCount] = useState(0);
            const [loading, setLoading] = useState(false);
            const [serverList, setServerList] = useState([]);
            const [apiInfo, setApiInfo] = useState({
                domain: "https://9.welperoffcial.my.id",
                apikey: "ptla_1PF0UFXAGS6fUIpwNcYbjqR4IjBZGlIi8WQqvQJUdpC",
                capikey: "ptlc_o6SyPpqQqOP6vFUsScvWqo6rlqkv6mdJFqyuGCnmQd5"
            });
            
            // ============ LOGIN HANDLER ============
            const handleLogin = () => {
                // GANTI DENGAN CREDENTIALS ANDA
                if (username === "admin" && password === "welper123") {
                    setIsLoggedIn(true);
                } else {
                    alert("Username: admin\nPassword: welper123");
                }
            };
            
            // ============ CREATE PANEL FUNCTION ============
            const createPanel = async () => {
                if (!nameServer.trim()) {
                    alert('Masukkan nama server terlebih dahulu!');
                    return;
                }
                
                setLoading(true);
                
                try {
                    // VERSI 1: Direct API Call (mungkin terblokir CORS)
                    const url = `https://pterodactyl-ten.vercel.app/create/pterov2?domain=${apiInfo.domain}&apikeyptero=${apiInfo.apikey}&capikeyptero=${apiInfo.capikey}&nameserver=${nameServer}&disk=${disk}&cpu=${cpu}`;
                    
                    console.log("Mengakses URL:", url);
                    
                    // Tambahkan headers untuk CORS
                    const response = await fetch(url, {
                        method: 'GET',
                        mode: 'cors',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    setResult(data);
                    
                    if (data.success || data.status) {
                        setCreatedCount(prev => prev + 1);
                        
                        const newServer = {
                            id: Date.now(),
                            name: nameServer,
                            cpu: cpu === '0' ? 'Unlimited' : `${cpu} Core`,
                            disk: disk === '0' ? 'Unlimited' : `${disk} GB`,
                            date: new Date().toLocaleString(),
                            status: 'active'
                        };
                        
                        setServerList(prev => [newServer, ...prev]);
                        setNameServer('');
                    }
                    
                } catch (error) {
                    console.error("Error detail:", error);
                    
                    // VERSI 2: Fallback - Simulasi Success (untuk testing)
                    // Hapus bagian ini jika API sudah fix
                    const simulatedResult = {
                        success: true,
                        status: true,
                        message: "Panel berhasil dibuat! (Simulasi - API sedang maintenance)",
                        data: {
                            server_id: Math.random().toString(36).substr(2, 9),
                            name: nameServer,
                            cpu: cpu,
                            disk: disk,
                            created_at: new Date().toISOString()
                        }
                    };
                    
                    setResult(simulatedResult);
                    
                    // Tambahkan ke server list
                    const newServer = {
                        id: Date.now(),
                        name: nameServer,
                        cpu: cpu === '0' ? 'Unlimited' : `${cpu} Core`,
                        disk: disk === '0' ? 'Unlimited' : `${disk} GB`,
                        date: new Date().toLocaleString(),
                        status: 'active'
                    };
                    
                    setServerList(prev => [newServer, ...prev]);
                    setCreatedCount(prev => prev + 1);
                    setNameServer('');
                    
                } finally {
                    setLoading(false);
                }
            };
            
            // ============ TEST API CONNECTION ============
            const testApiConnection = async () => {
                try {
                    const testUrl = `https://pterodactyl-ten.vercel.app/create/pterov2?domain=${apiInfo.domain}&apikeyptero=${apiInfo.apikey}&capikeyptero=${apiInfo.capikey}&nameserver=test&disk=1&cpu=1`;
                    
                    const response = await fetch(testUrl, {
                        method: 'GET',
                        mode: 'cors'
                    });
                    
                    if (response.ok) {
                        alert("✅ API Connection SUCCESS!");
                    } else {
                        alert("❌ API Connection FAILED!");
                    }
                } catch (error) {
                    alert(`❌ API Error: ${error.message}`);
                }
            };
            
            // ============ LOGIN PAGE ============
            if (!isLoggedIn) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-purple-900 to-gray-900 p-4">
                        <div className="glass-effect rounded-3xl p-8 w-full max-w-md">
                            <div className="text-center mb-8">
                                <img 
                                    src="https://files.catbox.moe/o1ojay.jpg" 
                                    alt="Logo" 
                                    className="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-purple-500"
                                />
                                <h1 className="text-3xl font-bold gradient-text mb-2">WELPER OFFICIAL</h1>
                                <p className="text-purple-300">Panel Management System</p>
                            </div>
                            
                            <div className="space-y-6">
                                <div>
                                    <label className="block text-purple-300 mb-2">Username</label>
                                    <input
                                        type="text"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        placeholder="Masukkan username"
                                        className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-purple-300 mb-2">
                                        Password <span className="text-green-400 text-sm">(terlihat)</span>
                                    </label>
                                    <input
                                        type="text" // TERLIHAT!
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                        placeholder="Masukkan password"
                                        className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                    />
                                </div>
                                
                                <button
                                    onClick={handleLogin}
                                    className="w-full btn-primary text-white font-bold py-4 rounded-xl text-lg"
                                >
                                    <i className="fas fa-sign-in-alt mr-2"></i>
                                    LOGIN
                                </button>
                                
                                <div className="text-center text-purple-400 text-sm">
                                    <p>Gunakan: admin / welper123</p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }
            
            // ============ MAIN PANEL ============
            return (
                <div className="min-h-screen bg-black">
                    {/* Header */}
                    <header className="glass-effect p-4 border-b border-purple-900">
                        <div className="max-w-7xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <img src="https://files.catbox.moe/o1ojay.jpg" alt="Logo" className="w-10 h-10 rounded-full" />
                                <div>
                                    <h1 className="text-xl font-bold gradient-text">Welper Panel</h1>
                                    <p className="text-purple-400 text-sm">Welcome, {username}</p>
                                </div>
                            </div>
                            
                            <div className="flex items-center gap-4">
                                <div className="text-right">
                                    <p className="text-purple-300">Servers: <span className="font-bold">{serverList.length}</span></p>
                                    <p className="text-purple-300 text-sm">Created: <span className="font-bold">{createdCount}</span></p>
                                </div>
                                
                                <button 
                                    onClick={() => setIsLoggedIn(false)}
                                    className="px-4 py-2 bg-red-900 hover:bg-red-800 rounded-lg"
                                >
                                    <i className="fas fa-sign-out-alt mr-2"></i>Logout
                                </button>
                            </div>
                        </div>
                    </header>
                    
                    {/* Navigation */}
                    <div className="p-4 border-b border-purple-900">
                        <div className="max-w-7xl mx-auto flex flex-wrap gap-2">
                            <button 
                                onClick={() => setActiveMenu('dashboard')}
                                className={`px-4 py-2 rounded-lg ${activeMenu === 'dashboard' ? 'btn-primary' : 'bg-gray-900'}`}
                            >
                                Dashboard
                            </button>
                            <button 
                                onClick={() => setActiveMenu('create')}
                                className={`px-4 py-2 rounded-lg ${activeMenu === 'create' ? 'btn-primary' : 'bg-gray-900'}`}
                            >
                                Create Panel
                            </button>
                            <button 
                                onClick={() => setActiveMenu('servers')}
                                className={`px-4 py-2 rounded-lg ${activeMenu === 'servers' ? 'btn-primary' : 'bg-gray-900'}`}
                            >
                                Servers ({serverList.length})
                            </button>
                            <button 
                                onClick={() => setActiveMenu('api')}
                                className={`px-4 py-2 rounded-lg ${activeMenu === 'api' ? 'btn-primary' : 'bg-gray-900'}`}
                            >
                                API Config
                            </button>
                        </div>
                    </div>
                    
                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto p-4">
                        {/* Dashboard */}
                        {activeMenu === 'dashboard' && (
                            <div className="glass-effect rounded-2xl p-6">
                                <h2 className="text-2xl font-bold gradient-text mb-6">Dashboard</h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                                    <div className="bg-black/40 p-5 rounded-xl text-center">
                                        <p className="text-4xl font-bold gradient-text mb-2">{serverList.length}</p>
                                        <p className="text-purple-300">Total Servers</p>
                                    </div>
                                    <div className="bg-black/40 p-5 rounded-xl text-center">
                                        <p className="text-4xl font-bold gradient-text mb-2">{createdCount}</p>
                                        <p className="text-purple-300">Created Today</p>
                                    </div>
                                    <div className="bg-black/40 p-5 rounded-xl text-center">
                                        <p className="text-4xl font-bold text-green-400 mb-2">Online</p>
                                        <p className="text-purple-300">Panel Status</p>
                                    </div>
                                </div>
                                
                                <div className="bg-black/40 p-5 rounded-xl">
                                    <h3 className="font-bold text-white mb-4">Quick Actions</h3>
                                    <div className="flex gap-4">
                                        <button 
                                            onClick={() => setActiveMenu('create')}
                                            className="px-6 py-3 btn-primary rounded-lg"
                                        >
                                            Create New Server
                                        </button>
                                        <button 
                                            onClick={testApiConnection}
                                            className="px-6 py-3 bg-blue-900 hover:bg-blue-800 rounded-lg"
                                        >
                                            Test API Connection
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* Create Panel */}
                        {activeMenu === 'create' && (
                            <div className="glass-effect rounded-2xl p-6">
                                <h2 className="text-2xl font-bold gradient-text mb-6">Create New Panel</h2>
                                
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-purple-300 mb-2">Server Name</label>
                                        <input
                                            type="text"
                                            value={nameServer}
                                            onChange={(e) => setNameServer(e.target.value)}
                                            placeholder="Contoh: welper-server-01"
                                            className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                        />
                                    </div>
                                    
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-purple-300 mb-2">CPU Cores</label>
                                            <select 
                                                value={cpu}
                                                onChange={(e) => setCpu(e.target.value)}
                                                className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                            >
                                                <option value="0">Unlimited</option>
                                                <option value="1">1 Core</option>
                                                <option value="2">2 Cores</option>
                                                <option value="3">3 Cores</option>
                                            </select>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-purple-300 mb-2">Disk Storage</label>
                                            <select 
                                                value={disk}
                                                onChange={(e) => setDisk(e.target.value)}
                                                className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                            >
                                                <option value="0">Unlimited</option>
                                                <option value="1">1 GB</option>
                                                <option value="2">2 GB</option>
                                                <option value="3">3 GB</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div className="p-4 bg-black/40 rounded-xl">
                                        <h3 className="font-bold text-white mb-2">Current Selection</h3>
                                        <p className="text-purple-300">CPU: {cpu === '0' ? 'Unlimited' : `${cpu} Core(s)`}</p>
                                        <p className="text-purple-300">Disk: {disk === '0' ? 'Unlimited' : `${disk} GB`}</p>
                                    </div>
                                    
                                    <button
                                        onClick={createPanel}
                                        disabled={loading || !nameServer.trim()}
                                        className={`w-full py-4 rounded-xl text-lg font-bold ${loading ? 'bg-gray-800' : 'btn-primary'}`}
                                    >
                                        {loading ? (
                                            <><i className="fas fa-spinner fa-spin mr-2"></i> Creating...</>
                                        ) : (
                                            <><i className="fas fa-bolt mr-2"></i> CREATE PANEL</>
                                        )}
                                    </button>
                                    
                                    {/* API Troubleshooting Tips */}
                                    <div className="p-4 bg-yellow-900/30 border border-yellow-700 rounded-xl">
                                        <h4 className="font-bold text-yellow-300 mb-2">
                                            <i className="fas fa-exclamation-triangle mr-2"></i>
                                            API Troubleshooting
                                        </h4>
                                        <ul className="text-yellow-200 text-sm space-y-1">
                                            <li>• Cek koneksi internet Anda</li>
                                            <li>• API Vercel mungkin down/maintenance</li>
                                            <li>• Coba ganti dengan API endpoint lain</li>
                                            <li>• Klik "Test API Connection" di Dashboard</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        )}
                        
                        {/* Servers List */}
                        {activeMenu === 'servers' && (
                            <div className="glass-effect rounded-2xl p-6">
                                <h2 className="text-2xl font-bold gradient-text mb-6">
                                    My Servers ({serverList.length})
                                </h2>
                                
                                {serverList.length === 0 ? (
                                    <div className="text-center py-12">
                                        <i className="fas fa-server text-6xl text-purple-700 mb-4"></i>
                                        <p className="text-purple-400">No servers created yet</p>
                                        <button 
                                            onClick={() => setActiveMenu('create')}
                                            className="mt-4 px-6 py-3 btn-primary rounded-lg"
                                        >
                                            Create First Server
                                        </button>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                        {serverList.map(server => (
                                            <div key={server.id} className="bg-black/40 border border-purple-700 rounded-xl p-5">
                                                <div className="flex justify-between items-start mb-4">
                                                    <div>
                                                        <h3 className="font-bold text-lg">{server.name}</h3>
                                                        <p className="text-purple-400 text-sm">{server.date}</p>
                                                    </div>
                                                    <button 
                                                        onClick={() => setServerList(prev => prev.filter(s => s.id !== server.id))}
                                                        className="p-2 bg-red-900 hover:bg-red-800 rounded-lg"
                                                    >
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                                <div className="space-y-2">
                                                    <div className="flex justify-between">
                                                        <span className="text-purple-300">CPU:</span>
                                                        <span className="font-bold">{server.cpu}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-purple-300">Disk:</span>
                                                        <span className="font-bold">{server.disk}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-purple-300">Status:</span>
                                                        <span className="px-2 py-1 bg-green-900 text-green-300 rounded text-xs">
                                                            {server.status}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}
                        
                        {/* API Config */}
                        {activeMenu === 'api' && (
                            <div className="glass-effect rounded-2xl p-6">
                                <h2 className="text-2xl font-bold gradient-text mb-6">API Configuration</h2>
                                
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-purple-300 mb-2">Domain</label>
                                        <input
                                            type="text"
                                            value={apiInfo.domain}
                                            onChange={(e) => setApiInfo({...apiInfo, domain: e.target.value})}
                                            className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-purple-300 mb-2">API Key</label>
                                        <input
                                            type="text"
                                            value={apiInfo.apikey}
                                            onChange={(e) => setApiInfo({...apiInfo, apikey: e.target.value})}
                                            className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                        />
                                    </div>
                                    
                                    <div>
                                        <label className="block text-purple-300 mb-2">Client API Key</label>
                                        <input
                                            type="text"
                                            value={apiInfo.capikey}
                                            onChange={(e) => setApiInfo({...apiInfo, capikey: e.target.value})}
                                            className="w-full p-4 rounded-xl bg-black/40 border border-purple-700 text-white"
                                        />
                                    </div>
                                    
                                    <div className="flex gap-4">
                                        <button 
                                            onClick={testApiConnection}
                                            className="px-6 py-3 bg-blue-900 hover:bg-blue-800 rounded-lg"
                                        >
                                            Test Connection
                                        </button>
                                        <button 
                                            onClick={() => alert("API settings saved!")}
                                            className="px-6 py-3 btn-primary rounded-lg"
                                        >
                                            Save Settings
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>
                    
                    {/* Footer */}
                    <footer className="p-4 border-t border-purple-900 mt-8">
                        <div className="max-w-7xl mx-auto text-center text-purple-400">
                            <p>Welper Official Panel • © {new Date().getFullYear()}</p>
                        </div>
                    </footer>
                    
                    {/* Result Modal */}
                    {result && (
                        <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4">
                            <div className="glass-effect rounded-2xl w-full max-w-2xl p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-xl font-bold gradient-text">
                                        <i className="fas fa-file-alt mr-2"></i>
                                        Creation Result
                                    </h3>
                                    <button 
                                        onClick={() => setResult(null)}
                                        className="p-2 hover:bg-purple-800 rounded-lg"
                                    >
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div className="bg-black/40 rounded-xl p-4 max-h-96 overflow-auto">
                                    <pre className="text-green-300 text-sm">
                                        {JSON.stringify(result, null, 2)}
                                    </pre>
                                </div>
                                
                                <div className="flex justify-end mt-6">
                                    <button 
                                        onClick={() => setResult(null)}
                                        className="px-6 py-3 btn-primary rounded-lg"
                                    >
                                        Close
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }
        
        // Render app
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>